{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export const createGalleryCardTemplate = imgInfo => {\n\n  return `\n    <li class=\"gallery-card\">\n    <a class = \"js-gallery-link\" href = \"${imgInfo.largeImageURL}\"> <img class=\"gallery-img\" src=\"${imgInfo.webformatURL}\" alt=\"${imgInfo.tags}\"/></a>\n    <div class=\"stats-container\">\n        <ul class=\"stats-list\">\n            <li class=\"gallery-item\">\n                <span class=\"label\">Likes</span>\n                <span class=\"value\">${imgInfo.likes}</span>\n            </li>\n            <li class=\"gallery-item\">\n                <span class=\"label\">Views</span>\n                <span class=\"value\">${imgInfo.views}</span>\n            </li>\n            <li class=\"gallery-item\">\n                <span class=\"label\">Comments</span>\n                <span class=\"value\">${imgInfo.comments}</span>\n            </li>\n            <li class=\"gallery-item\">\n                <span class=\"label\">Downloads</span>\n                <span class=\"value\">${imgInfo.downloads}</span>\n            </li>\n        </ul>\n    </div>\n</li>`\n};","import axios from \"axios\";\n\naxios.defaults.baseURL = 'https://pixabay.com'\n\nconst refs = {\n    loader: document.querySelector('.js-loader'),\n}\n\nexport const fetchPhotosByQuery = async (query, currentPage) => {\n\n    const axiosParams = \n        {\n            key: '52947144-373b760a7dc07b63f24b6c37a',\n            q: query,\n            image_type: 'photo',\n            orientation: 'horizontal',\n            page: currentPage,\n            per_page: 15,\n            safesearch: true,\n        };\n\n    // return axios.get( '/api/?', {params: axiosParams}).finally(() => {\n    //     refs.loader.classList.remove('is-active');\n    // });\n\n    const response = await axios.get( '/api/?', {params: axiosParams});\n    \n    return response.data;\n};","import iziToast from \"izitoast\";\n// Additional style import for iziToast. This ensures the necessary CSS is loaded for the notifications.\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { createGalleryCardTemplate } from './js/render-functions'; // Function to create the HTML markup for a single gallery item.\nimport {fetchPhotosByQuery} from \"./js/pixabay-api\" // API call function to fetch images from Pixabay based on a search query.\n\n// SimpleLightbox library import (as described in documentation). Used for creating a modal/slideshow view of the images.\nimport SimpleLightbox from \"simplelightbox\";\n// Additional style import for SimpleLightbox. This ensures the necessary CSS is loaded for the lightbox component.\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n// Variable to hold the SimpleLightbox instance. Initialized to null.\nlet lightboxInstance = null;\n\n// LIGHTBOX INITIALIZATION/UPDATE FUNCTION\n// This function initializes the SimpleLightbox or refreshes it after new images are added to the DOM.\nconst initLightbox = () => {\n    // If the instance hasn't been created yet (first time loading gallery), create it.\n    if (!lightboxInstance) {\n        lightboxInstance = new SimpleLightbox('.js-gallery a', {\n            // Target all <a> tags within the gallery container (.js-gallery) for the lightbox functionality.\n            captionDelay: 250, // Delay in milliseconds before the caption appears.\n            captionsData: 'alt', // Specify to use the 'alt' attribute of the image for the caption text.\n        });\n    } else {\n        // If the instance already exists, refresh it to include any newly added images in the gallery.\n        lightboxInstance.refresh();\n    }\n}\n\n\n// Form elements references. Grouping DOM elements here makes them easy to access and manage.\nconst refs = {\n    searchForm: document.querySelector('.js-search-form'), // Reference to the main search form element.\n    gallery: document.querySelector('.js-gallery'), // Reference to the container where gallery cards are rendered.\n    loader: document.querySelector('.js-loader'),\n    loadMoreBtn: document.querySelector('.js-load-more-btn'),\n}\n\n\nlet page = 1;\nlet searchedQuery;\n\nconst onLoadMoreBtnClick = async event => {\n    try{\n        page++;\n        refs.loader.classList.add('is-active')\n        const response = await fetchPhotosByQuery(searchedQuery, page);\n        const galleryCardTemplate = response.hits.map(pictureInfo => createGalleryCardTemplate(pictureInfo)).join('')\n        \n        // Insert the generated HTML string of gallery cards into the gallery container.\n        refs.gallery.insertAdjacentHTML('beforeend', galleryCardTemplate);\n\n       \n        \n        // Initialize or refresh the SimpleLightbox to include the newly rendered images.\n        initLightbox();\n        refs.loader.classList.remove('is-active')\n\n        const firstGalleryCard = document.querySelector('.gallery-card');\n\n        const cardHeight = firstGalleryCard.getBoundingClientRect().height;\n        \n        const scrollDistance = cardHeight * 2;\n\n        window.scrollBy({\n            top: scrollDistance, \n            behavior: \"smooth\"   \n        });\n\n        if (page * 15 >= response.totalHits) {\n            refs.loadMoreBtn.classList.add('is-hidden')\n            refs.loadMoreBtn.removeEventListener('click', onLoadMoreBtnClick)\n            iziToast.show({\n    message: \"We're sorry, but you've reached the end of search results.\",\n    color: 'blue', // Set notification color to red.\n    position: 'topCenter', // Position the notification.\n\n});\n\n        }\n        \n\n    }catch (err) {\n        console.log(err);\n    }\n\n}\n\n\n// Handler function executed when the search form is submitted.\nconst onSearchFormSubmit = async event => {\n    event.preventDefault(); // Prevent the default form submission and page reload.\n\n    // Destructure the target element from the event object for easier access.\n    const {target : searchForm} = event;\n\n    // Get the value from the input field named 'user_query' and remove leading/trailing whitespace.\n    searchedQuery = searchForm.elements.user_query.value.trim()\n    \n\n    // Validation: Check if the search query is empty.\n    if (searchedQuery.length === 0) {\n        \n            // Display an error notification using iziToast if the query is empty.\n            iziToast.show({\n            title: \"WARNING\",\n            message: `Search query cannot be empty!`,\n            color: 'red', // Set notification color to red for warnings/errors.\n            position: 'topCenter', // Position the notification at the top center of the screen.\n\n        });\n\n        return; // Stop the function execution if the query is empty.\n    }\n    // Clear the existing gallery content before fetching and displaying new results.\n    refs.gallery.innerHTML = '';\n\n    refs.loader.classList.add('is-active')\n    refs.loadMoreBtn.classList.add('is-hidden')\n    page = 1\n    \n\n    try{\n        const response = await fetchPhotosByQuery(searchedQuery, page);\n\n        // Check if the API returned no results (hits array is empty).\n        if (response.hits.length === 0){\n            // Display a notification if no images were found for the query.\n            iziToast.show({\n    message: 'Sorry, there are no images matching your search query. Please try again!',\n    color: 'red', // Set notification color to red.\n    position: 'topCenter', // Position the notification.\n\n});\n    return // Stop execution if no hits are found.\n        }\n\n    if(response.totalHits > response.hits.length){\n        refs.loadMoreBtn.classList.remove('is-hidden');\n        refs.loadMoreBtn.addEventListener('click', onLoadMoreBtnClick);\n    } else {\n            // Сховати кнопку, якщо всі результати помістилися на першу сторінку\n        refs.loadMoreBtn.classList.add('is-hidden');\n     }\n\n        \n\n\n        // Map over the array of picture data (data.hits) and create an HTML card template for each.\n        // Then, join the array of HTML strings into a single string.\n        const galleryCardTemplate = response.hits.map(pictureInfo => createGalleryCardTemplate(pictureInfo)).join('')\n        \n        // Insert the generated HTML string of gallery cards into the gallery container.\n        refs.gallery.innerHTML = galleryCardTemplate\n        \n        \n        // Initialize or refresh the SimpleLightbox to include the newly rendered images.\n        initLightbox();\n        \n        // refs.loadMoreBtn.classList.remove('is-hidden')\n    } catch (err) {\n        console.log(err);\n    } finally {\n    \n        refs.loader.classList.remove('is-active')\n    }\n}\n\n// Attach the event listener to the search form to trigger the submission handler.\nrefs.searchForm.addEventListener('submit', onSearchFormSubmit)"],"names":["createGalleryCardTemplate","imgInfo","axios","fetchPhotosByQuery","query","currentPage","axiosParams","lightboxInstance","initLightbox","SimpleLightbox","refs","page","searchedQuery","onLoadMoreBtnClick","event","response","galleryCardTemplate","pictureInfo","scrollDistance","iziToast","err","onSearchFormSubmit","searchForm"],"mappings":"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"}